webpackJsonp([46],{"/Y5x":function(t,e){},goLA:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Xxa5"),r=a.n(s),i=a("exGp"),o=a.n(i),n=a("gyMJ"),l={data:function(){return{formData:{role_name:"",remarks:"",role_type:"",node_ids:"",disabledS:!0},method_auth:{actAdd:0,actEdit:0,actDelete:0,setState:0},tableHeight:window.innerHeight-180,title:"",listId:"",hash:"",dialogVisible:!1,tableHead:[{title:"编号",prop:"id",width:"100"},{title:"角色名",prop:"role_name",width:"300"},{title:"角色类型",prop:"role_type",width:"300"},{title:"描述",prop:"remarks"},{title:"状态",prop:"disabled"}],nodesData:[],tableData:[],rule:{role_name:[{required:!0,message:"请选择角色名称",trigger:"blur"}],role_type:[{required:!0,message:"请选择权限范围",trigger:"change"}]},defaultProps:{children:"children",label:"node_name",disabled:"defaulted"},startOption:{},rolesData:[],defaulted:"",isLoading:!1}},mounted:function(){this.getList()},methods:{resetForm:function(){this.formData={role_name:"",remarks:"",role_type:"",node_ids:""},this.nodeData=[]},addBtn:function(){this.title="新增",this.dialogVisible=!0,this.resetForm(),this.getInfoData(),this.getHash()},editBtn:function(t){this.title="编辑",this.dialogVisible=!0,this.formData.role_name=t.role_name,this.formData.role_type=t.role_type,this.formData.remarks=t.remarks,this.formData.disabledS=0==t.disabled,this.listId=t.id,this.getInfoData(),this.getRolesData(t.id),this.getHash()},submitForm:function(t){var e,a=this;this.$refs[t].validate((e=o()(r.a.mark(function t(e){var s,i,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=10;break}return s={disabled:1==a.formData.disabledS?0:1,role_name:a.formData.role_name,role_type:a.formData.role_type,node_ids:a.$refs.tree.getCheckedKeys().concat(a.$refs.tree.getHalfCheckedKeys()).join(","),remarks:a.formData.remarks,hash:a.hash},"新增"==a.title?i=n._92:"编辑"==a.title&&(i=n._94,s.id=a.listId),t.next=5,a.axios.post(i,s);case 5:1==(o=t.sent).data.code?(a.dialogVisible=!1,a.getList()):a.$message({showClose:!0,message:o.data.msg,type:"error"}),a.getHash(),t.next=12;break;case 10:return console.log("error submit!!"),t.abrupt("return",!1);case 12:case"end":return t.stop()}},t,a)})),function(t){return e.apply(this,arguments)}))},delBtn:function(t){var e=this;return o()(r.a.mark(function a(){return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e.$confirm("是否删除该条数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(o()(r.a.mark(function a(){var s,i;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s={id:t},a.next=3,e.axios.post(n._93,s);case 3:1==(i=a.sent).data.code?e.getList():e.$message({showClose:!0,message:i.data.msg,type:"error"}),e.getHash();case 6:case"end":return a.stop()}},a,e)}))).catch(function(){e.$message({type:"info",message:"已取消删除"})});case 1:case"end":return a.stop()}},a,e)}))()},getInfoData:function(t){var e=this;return o()(r.a.mark(function a(){var s,i;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s={id:t},a.next=3,e.axios.post(n._96,s);case 3:1==(i=a.sent).data.code?e.nodesData=i.data.data:e.$message({showClose:!0,message:i.data.msg,type:"error"});case 5:case"end":return a.stop()}},a,e)}))()},getRolesData:function(t){var e=this;return o()(r.a.mark(function a(){var s,i;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s={role_id:t},a.next=3,e.axios.post(n._97,s);case 3:1==(i=a.sent).data.code?(console.log(i.data),e.rolesData=i.data.data.split(",")):e.$message({showClose:!0,message:i.data.msg,type:"error"});case 5:case"end":return a.stop()}},a,e)}))()},getList:function(){var t=this;return o()(r.a.mark(function e(){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.next=3,t.axios.post(n._95,{});case 3:1==(a=e.sent).data.code?(t.tableData=a.data.data.data,t.defaulted=a.data.data.defaulted,t.isLoading=!1):(t.isLoading=!1,t.$message({showClose:!0,message:a.data.msg,type:"error"}));case 5:case"end":return e.stop()}},e,t)}))()},getHash:function(){var t=this;return o()(r.a.mark(function e(){var a,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={page_hash:"roleManagement"},e.next=3,t.axios.post(n._20,a);case 3:1==(s=e.sent).data.code?t.hash=s.data.data:t.$message({showClose:!0,message:s.data.msg,type:"error"});case 5:case"end":return e.stop()}},e,t)}))()}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main"},[a("div",{staticClass:"roleManagement"},[a("div",{staticClass:"searchA"},[a("div",{staticClass:"add"},[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:t.addBtn}},[t._v("新增")])],1)]),t._v(" "),a("div",{staticClass:"home_table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"","max-height":t.tableHeight,size:"medium"}},[t._l(t.tableHead,function(e,s){return["状态"==e.title?a("el-table-column",{key:s,attrs:{prop:e.prop,label:e.title,width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.disabled?a("span",{staticStyle:{color:"#409EFF"}},[t._v("启用")]):1==e.row.disabled?a("span",{staticStyle:{color:"#F56C6C"}},[t._v("禁用")]):t._e()]}}],null,!0)}):a("el-table-column",{key:s,attrs:{prop:e.prop,label:e.title,width:e.width,"show-overflow-tooltip":!0}})]}),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"操作",fixed:"right",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.editBtn(e.row)}}},[t._v("编辑")]),t._v(" "),1==t.defaulted?a("el-button",{staticStyle:{color:"#ff2b2b"},attrs:{type:"text",size:"small"},on:{click:function(a){return t.delBtn(e.row.id)}}},[t._v("删除")]):t._e()]}}])})],2)],1),t._v(" "),t.dialogVisible?a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:t.title,visible:t.dialogVisible,width:"700px","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticStyle:{"padding-left":"20px"}},[a("el-form",{ref:"formData",attrs:{model:t.formData,rules:t.rule,"status-icon":"","label-position":"top","label-width":"100px",inline:!0}},[a("div",{staticClass:"dialogInput",staticStyle:{display:"flex"}},[a("div",{staticClass:"padd",staticStyle:{"margin-right":"10px"}},[a("el-form-item",{attrs:{label:"角色名称",prop:"role_name"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择角色名称",size:"small"},model:{value:t.formData.role_name,callback:function(e){t.$set(t.formData,"role_name",e)},expression:"formData.role_name"}})],1)],1),t._v(" "),a("div",{staticClass:"padd",staticStyle:{"margin-right":"10px"}},[a("el-form-item",{attrs:{label:"角色状态"}},[a("el-switch",{model:{value:t.formData.disabledS,callback:function(e){t.$set(t.formData,"disabledS",e)},expression:"formData.disabledS"}})],1)],1)]),t._v(" "),a("div",{staticClass:"dialogInput",staticStyle:{display:"flex"}},[a("div",{staticClass:"padd",staticStyle:{"margin-right":"10px"}},[a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"角色描述",prop:"remarks"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入角色描述（60个字符以内）",size:"small"},model:{value:t.formData.remarks,callback:function(e){t.$set(t.formData,"remarks",e)},expression:"formData.remarks"}})],1)],1)]),t._v(" "),a("div",{staticClass:"dialogInput"},[a("div",{staticClass:"padd"},[a("div",{staticClass:"paddTit"},[t._v("资源权限")]),t._v(" "),a("div",{staticClass:"tree_main"},[a("el-form-item",[a("el-tree",{ref:"tree",attrs:{data:t.nodesData,"show-checkbox":"","check-on-click-node":"","node-key":"id","default-checked-keys":t.rolesData,"default-expand-all":"",props:t.defaultProps}})],1)],1)])]),t._v(" "),a("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[a("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:function(e){return t.submitForm("formData")}}},[t._v("确 定")])],1)])],1)]):t._e()],1)])},staticRenderFns:[]};var c=a("VU/8")(l,d,!1,function(t){a("/Y5x")},"data-v-07e552f4",null);e.default=c.exports}});
//# sourceMappingURL=46.fcc2ef9193fa957057e7.js.map