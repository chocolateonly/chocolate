webpackJsonp([17],{NqLC:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("mvHQ"),o=a.n(s),l=a("Xxa5"),i=a.n(l),n=a("exGp"),r=a.n(n),c=a("gyMJ"),d={data:function(){return{total:0,pageNum:1,pageSize:15,isLoading:!1,tableHeight:window.innerHeight-180,formData:{month:"",year:"",term:"",personal_score:"",class_score:""},method_auth:{},editId:"",title:"",search:{month:"",year:""},dialogVisible:!1,tableHead:[{title:"ID",prop:"id",minWidth:"100"},{title:"学生姓名",prop:"student_name",minWidth:"120"},{title:"班级",prop:"class_name",minWidth:"100"},{title:"年份",prop:"year",minWidth:"120"},{title:"学期",prop:"term",minWidth:"150"},{title:"月份",prop:"month_name",minWidth:"150"}],tableData:[],tableInfo:[{type:1,achievement:"",discipline:"",hold_post:"",home_school:""}],tableInfoTwo:[{type:2,achievement:"",discipline:"",hold_post:"",home_school:""}],hash:"",gradeList:[],classList:[],studentFile_id:"",month_list:[],term_list:[],year_list:[],tableTitle:localStorage.getItem("studentFile_name")}},mounted:function(){this.studentFile_id=localStorage.getItem("studentFile_id"),this.getList(),this.resView(),this.getHash()},methods:{serchList:function(){this.pageNum=1,this.pageSize=15,this.getList()},handleSizeChange:function(e){this.pageNum=1,this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.pageNum=e,this.getList()},resView:function(){var e=this;return r()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.axios.post(c._114);case 2:1==(a=t.sent).data.code?(e.year_list=a.data.data.year_list,e.term_list=a.data.data.term_list,e.month_list=a.data.data.month_list):e.$message({showClose:!0,message:a.data.msg,type:"error"});case 4:case"end":return t.stop()}},t,e)}))()},getList:function(){var e=this;return r()(i.a.mark(function t(){var a,s;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={student_id:e.studentFile_id,curr:e.pageNum,pageSize:e.pageSize,month:e.search.month,year:e.search.year},t.next=3,e.axios.post(c._109,a);case 3:1==(s=t.sent).data.code?(e.tableData=s.data.data.data,e.total=s.data.data.total):e.$message({showClose:!0,message:s.data.msg,type:"error"});case 5:case"end":return t.stop()}},t,e)}))()},addBtn:function(){this.title="新增",this.dialogVisible=!0,this.resetForm()},edit:function(e){var t=this;this.title="编辑",this.dialogVisible=!0,this.resetForm(),this.$nextTick(function(){t.getInfo(e.id)})},getHash:function(){var e=this;return r()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.axios.post(c._20,{page_hash:"studentFile"});case 2:1==(a=t.sent).data.code?e.hash=a.data.data:e.$message({showClose:!0,message:a.data.msg,type:"error"});case 4:case"end":return t.stop()}},t,e)}))()},getInfo:function(e){var t=this;return r()(i.a.mark(function a(){var s;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.axios.post(c._112,{archives_id:e});case 2:1==(s=a.sent).data.code?(t.formData=s.data.data,t.tableInfo=[s.data.data.list[0]],t.tableInfoTwo=[s.data.data.list[1]]):t.$message({showClose:!0,message:s.data.msg,type:"error"});case 4:case"end":return a.stop()}},a,t)}))()},resetForm:function(){this.formData={month:"",year:"",term:"",personal_score:"",class_score:""},this.tableInfo=[{type:1,achievement:"",discipline:"",hold_post:"",home_school:""}],this.tableInfoTwo=[{type:2,achievement:"",discipline:"",hold_post:"",home_school:""}]},submit:function(){var e=this;return r()(i.a.mark(function t(){var a,s,l;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.getHash(),!(Number(e.formData.personal_score)<=0||Number(e.formData.class_score)<=0)){t.next=4;break}return e.$message({showClose:!0,message:"个人积分、班级均分需为正整数",type:"error"}),t.abrupt("return");case 4:return a={student_id:e.studentFile_id,month:e.formData.month,year:e.formData.year,term:e.formData.term,personal_score:e.formData.personal_score,class_score:e.formData.class_score,conduct_data:o()([e.$refs.tableInfo.data[0],e.$refs.tableInfoTwo.data[0]]),hash:e.hash},s=void 0,"新增"==e.title?s=c._108:(s=c._111,a.id=e.formData.id),t.next=9,e.axios.post(s,a);case 9:1==(l=t.sent).data.code?(e.$message({showClose:!0,message:l.data.msg,type:"success"}),e.dialogVisible=!1):e.$message({showClose:!0,message:l.data.msg,type:"error"}),e.getList(),e.getHash();case 13:case"end":return t.stop()}},t,e)}))()},delBtn:function(e){var t=this;this.$confirm("是否确定删除","删除提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a={archives_id:e,hash:t.hash};t.axios.post(c._110,a).then(function(e){1==e.data.code?(t.$notify.success({showClose:!0,message:e.data.msg,type:"success"}),(t.total-1)%t.pageSize==0&&t.total>1&&(t.page-=1),t.getList()):t.$notify.error({title:"失败",message:e.data.msg})});t.getHash()}).catch(function(e){})}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main"},[a("div",{staticClass:"studentFile"},[a("div",{staticClass:"searchA"},[a("el-date-picker",{attrs:{clearable:"","value-format":"yyyy",size:"small",type:"year",placeholder:"选择年"},model:{value:e.search.year,callback:function(t){e.$set(e.search,"year",t)},expression:"search.year"}}),e._v(" "),a("el-select",{attrs:{clearable:"",placeholder:"请选择",size:"small"},model:{value:e.search.month,callback:function(t){e.$set(e.search,"month",t)},expression:"search.month"}},e._l(e.month_list,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",plain:"",icon:"el-icon-search"},on:{click:function(t){return e.serchList()}}},[e._v("查询")]),e._v(" "),a("div",{staticClass:"add"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.addBtn()}}},[e._v("新增档案")])],1)],1),e._v(" "),a("div",{staticClass:"home_table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","element-loading-background":"rgba(0, 0, 0, 0.4)",size:"medium","max-height":e.tableHeight}},[e._l(e.tableHead,function(e,t){return[a("el-table-column",{key:t,attrs:{prop:e.prop,label:e.title,"show-overflow-tooltip":!0,"min-width":e.minWidth}})]}),e._v(" "),a("el-table-column",{attrs:{prop:"address",align:"center",label:"操作",fixed:"right",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.edit(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{staticStyle:{color:"#ff2b2b"},attrs:{type:"text",size:"small"},on:{click:function(a){return e.delBtn(t.row.id)}}},[e._v("删除")])]}}])})],2),e._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{staticClass:"pagination",attrs:{background:"","current-page":e.pageNum,"page-sizes":[15,30,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.total,"hide-on-single-page":e.total<15},on:{"update:currentPage":function(t){e.pageNum=t},"update:current-page":function(t){e.pageNum=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:e.title,visible:e.dialogVisible,width:"60%","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-descriptions",{staticClass:"margin-top",attrs:{colon:!1,title:e.tableTitle,column:1,direction:"vertical"}},[a("el-descriptions-item",[a("span",{staticStyle:{"margin-right":"40px"}},[a("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择"},model:{value:e.formData.month,callback:function(t){e.$set(e.formData,"month",t)},expression:"formData.month"}},e._l(e.month_list,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),e._v("\n                        在校表现\n                    ")],1),e._v(" "),a("span",{staticStyle:{"margin-right":"20px"}},[e._v("\n                        学年度\n                        "),a("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择"},model:{value:e.formData.year,callback:function(t){e.$set(e.formData,"year",t)},expression:"formData.year"}},e._l(e.year_list,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})}),1)],1),e._v(" "),a("span",[e._v("\n                        学期\n                        "),a("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择"},model:{value:e.formData.term,callback:function(t){e.$set(e.formData,"term",t)},expression:"formData.term"}},e._l(e.term_list,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1)]),e._v(" "),a("el-descriptions-item",{attrs:{label:"第一、二周"}},[a("el-table",{ref:"tableInfo",staticStyle:{width:"100%"},attrs:{data:e.tableInfo,border:"","element-loading-background":"rgba(0, 0, 0, 0.4)",size:"medium"}},[a("el-table-column",{attrs:{prop:"achievement",label:"重要成绩及表彰","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",size:"small"},model:{value:t.row.achievement,callback:function(a){e.$set(t.row,"achievement",a)},expression:"scope.row.achievement"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"discipline",label:"重大违纪","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",size:"small"},model:{value:t.row.discipline,callback:function(a){e.$set(t.row,"discipline",a)},expression:"scope.row.discipline"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"hold_post",label:"担任职务或岗位","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",size:"small"},model:{value:t.row.hold_post,callback:function(a){e.$set(t.row,"hold_post",a)},expression:"scope.row.hold_post"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"home_school",label:"家校合作情况","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",size:"small"},model:{value:t.row.home_school,callback:function(a){e.$set(t.row,"home_school",a)},expression:"scope.row.home_school"}})]}}])})],1)],1),e._v(" "),a("el-descriptions-item",{attrs:{label:"第三、四周"}},[a("el-table",{ref:"tableInfoTwo",staticStyle:{width:"100%"},attrs:{data:e.tableInfoTwo,border:"","element-loading-background":"rgba(0, 0, 0, 0.4)",size:"medium"}},[a("el-table-column",{attrs:{prop:"achievement",label:"重要成绩及表彰","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",size:"small"},model:{value:t.row.achievement,callback:function(a){e.$set(t.row,"achievement",a)},expression:"scope.row.achievement"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"discipline",label:"重大违纪","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",size:"small"},model:{value:t.row.discipline,callback:function(a){e.$set(t.row,"discipline",a)},expression:"scope.row.discipline"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"hold_post",label:"担任职务或岗位","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",size:"small"},model:{value:t.row.hold_post,callback:function(a){e.$set(t.row,"hold_post",a)},expression:"scope.row.hold_post"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"home_school",label:"家校合作情况","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{clearable:"",size:"small"},model:{value:t.row.home_school,callback:function(a){e.$set(t.row,"home_school",a)},expression:"scope.row.home_school"}})]}}])})],1)],1),e._v(" "),a("el-descriptions-item",{attrs:{label:"个人积分"}},[a("el-input",{staticStyle:{width:"25%"},attrs:{maxlength:"10",clearable:"",size:"small"},model:{value:e.formData.personal_score,callback:function(t){e.$set(e.formData,"personal_score",e._n(t))},expression:"formData.personal_score"}})],1),e._v(" "),a("el-descriptions-item",{attrs:{label:"班级均分"}},[a("el-input",{staticStyle:{width:"25%"},attrs:{maxlength:"10",clearable:"",size:"small"},model:{value:e.formData.class_score,callback:function(t){e.$set(e.formData,"class_score",e._n(t))},expression:"formData.class_score"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var p=a("VU/8")(d,u,!1,function(e){a("lag/"),a("zU5h")},"data-v-5de61742",null);t.default=p.exports},"lag/":function(e,t){},zU5h:function(e,t){}});
//# sourceMappingURL=17.9ff91828b31fa109f43d.js.map