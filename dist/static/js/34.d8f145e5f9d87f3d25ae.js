webpackJsonp([34],{"9M2B":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Xxa5"),i=a.n(s),r=a("exGp"),n=a.n(r),o=a("gyMJ"),l={data:function(){return{total:0,page:1,pageSize:15,tableHeight:window.innerHeight-180,dialogVisible:!1,dialogVisiblecheck:!1,title:"",search:{warn_date:"",keyword:""},formData:{remark:""},weekBtn:[],tableHead:[{title:"序号",prop:"id",minWidth:"100"},{title:"预警班级",prop:"class_name",minWidth:"120"},{title:"班主任",prop:"manage_name",minWidth:"120"},{title:"病假人数",prop:"sick_count",minWidth:"180"},{title:"预警时间",prop:"time",minWidth:"160"},{title:"处理结果",prop:"todo_status_name",minWidth:"150"},{title:"班主任确认",prop:"confirm_status_name",minWidth:"100"}],tableData:[],rule:{remark:[{required:!0,message:"请输入处理情况",trigger:"blur"}]},deviceType:[],hash:"",week:[{id:"1",name:"星期一"},{id:"2",name:"星期二"},{id:"3",name:"星期三"},{id:"4",name:"星期四"},{id:"5",name:"星期五"},{id:"6",name:"星期六"},{id:"0",name:"星期天"}]}},mounted:function(){this.getList(),this.getHash()},methods:{serchList:function(){this.page=1,this.pageSize=15,this.getList()},handleSizeChange:function(e){this.page=1,this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.page=e,this.getList()},handle:function(e){this.dialogVisible=!0,this.resetForm(),this.getInfo(e.id)},check:function(e){this.dialogVisiblecheck=!0,this.getInfo(e.id)},resetForm:function(){var e=this;this.formData={remark:""},this.$nextTick(function(){e.$refs.formData.resetFields()})},handleClose:function(){this.resetForm(),this.dialogVisible=!1},getInfo:function(e){var t=this;return n()(i.a.mark(function a(){var s;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.axios.post(o._156,{id:e});case 2:1==(s=a.sent).data.code?t.formData=s.data.data:t.$message({showClose:!0,message:s.data.msg,type:"error"});case 4:case"end":return a.stop()}},a,t)}))()},getList:function(){var e=this;return n()(i.a.mark(function t(){var a,s;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={page:e.page,pageSize:e.pageSize,warn_date:e.search.warn_date,keyword:e.search.keyword},t.next=3,e.axios.post(o._157,a);case 3:1==(s=t.sent).data.code?(e.tableData=s.data.data.data,e.total=s.data.data.total):e.$message({showClose:!0,message:s.data.msg,type:"error"});case 5:case"end":return t.stop()}},t,e)}))()},getHash:function(){var e=this;return n()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.axios.post(o._20,{page_hash:"warningProcessing"});case 2:1==(a=t.sent).data.code?e.hash=a.data.data:e.$message({showClose:!0,message:a.data.msg,type:"error"});case 4:case"end":return t.stop()}},t,e)}))()},submit:function(){var e,t=this;this.$refs.formData.validate((e=n()(i.a.mark(function e(a){var s,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=10;break}return e.next=3,t.getHash();case 3:return s={id:t.formData.id,remark:t.formData.remark,hash:t.hash},e.next=6,t.axios.post(o._155,s);case 6:1==(r=e.sent).data.code?(t.$message({showClose:!0,message:r.data.msg,type:"success"}),t.dialogVisible=!1):t.$message({showClose:!0,message:r.data.msg,type:"error"}),t.getList(),t.getHash();case 10:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},delBtn:function(e){var t=this;this.$confirm("是否确定进行删除","删除提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a={id:e,hash:t.hash};t.axios.post(o._154,a).then(function(e){1==e.data.code?(t.$message({showClose:!0,message:e.data.msg,type:"error"}),(t.total-1)%t.pageSize==0&&t.total>1&&(t.page-=1),t.getList()):t.$message({showClose:!0,message:e.data.msg,type:"error"})});t.getHash()}).catch(function(e){})}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"equipmentManagement"},[a("div",{staticClass:"search"},[a("el-input",{attrs:{placeholder:"请输入预警班级",clearable:"",size:"small"},model:{value:e.search.keyword,callback:function(t){e.$set(e.search,"keyword","string"==typeof t?t.trim():t)},expression:"search.keyword"}}),e._v(" "),a("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small",clearable:"",type:"date",placeholder:"请选择预警日期"},model:{value:e.search.warn_date,callback:function(t){e.$set(e.search,"warn_date",t)},expression:"search.warn_date"}}),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",plain:"",icon:"el-icon-search"},on:{click:function(t){return e.serchList()}}},[e._v("查询")])],1),e._v(" "),a("div",{staticClass:"home_table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","element-loading-background":"rgba(0, 0, 0, 0.4)","max-height":e.tableHeight,size:"medium"}},[e._l(e.tableHead,function(t,s){return["time"==t.prop?a("el-table-column",{key:s,attrs:{prop:t.prop,align:"center",label:t.title,"min-width":t.minWidth},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.create_time+" "+t.row.week_name)+"\n                    ")]}}],null,!0)}):a("el-table-column",{key:s,attrs:{prop:t.prop,align:"center",label:t.title,"min-width":t.minWidth,"show-overflow-tooltip":!0}})]}),e._v(" "),a("el-table-column",{attrs:{prop:"address",label:"操作",fixed:"right",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.todo_status?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handle(t.row)}}},[e._v("处理")]):e._e(),e._v(" "),1==t.row.todo_status?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.check(t.row)}}},[e._v("查看")]):e._e(),e._v(" "),a("el-button",{staticStyle:{color:"#ff2b2b"},attrs:{type:"text",size:"small"},on:{click:function(a){return e.delBtn(t.row.id)}}},[e._v("删除")])]}}])})],2)],1),e._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{staticClass:"pagination",attrs:{background:"","current-page":e.page,"page-sizes":[15,30,50,100],"page-size":e.pageSize,layout:"prev, pager, next, sizes,total",total:e.total,"hide-on-single-page":e.total<15},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"预警处理",visible:e.dialogVisible,width:"700px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t},close:e.handleClose}},[a("el-form",{ref:"formData",attrs:{model:e.formData,rules:e.rule,"label-width":"110px"}},[a("el-form-item",{attrs:{label:"日期"}},[e._v("\n                "+e._s(e.formData.create_time+" "+e.formData.week_name)+"\n            ")]),e._v(" "),a("el-form-item",{attrs:{label:"预警班级"}},[e._v("\n                "+e._s(e.formData.class_name)+"\n            ")]),e._v(" "),a("el-form-item",{attrs:{label:"班主任"}},[e._v("\n                "+e._s(e.formData.manage_name)+"\n            ")]),e._v(" "),a("el-form-item",{attrs:{label:"病假人数"}},[e._v("\n                "+e._s(e.formData.sick_count)+"\n            ")]),e._v(" "),a("el-form-item",{attrs:{label:"病假人员"}},[e._v("\n                "+e._s(e.formData.student_name)+"\n            ")]),e._v(" "),a("el-form-item",{attrs:{label:"预警处理",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",autosize:"",maxlength:"200","show-word-limit":"",placeholder:"请输入处理情况"},model:{value:e.formData.remark,callback:function(t){e.$set(e.formData,"remark",t)},expression:"formData.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"查看预警",visible:e.dialogVisiblecheck,width:"700px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisiblecheck=t},close:function(t){e.dialogVisiblecheck=!1}}},[a("el-descriptions",{attrs:{column:1,border:"",labelStyle:{width:"15%"}}},[a("el-descriptions-item",{attrs:{label:"预警班级"}},[e._v(e._s(e.formData.class_name))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"班主任"}},[e._v(e._s(e.formData.manage_name))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"病假人数"}},[e._v(e._s(e.formData.sick_count))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"病假人员"}},[e._v(e._s(e.formData.student_name))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"日期"}},[e._v(e._s(e.formData.create_time+" "+e.formData.week_name))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"处理结果"}},[e._v(e._s(e.formData.todo_status_name))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"班主任确认"}},[e._v(e._s(e.formData.confirm_status_name))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"预警处理"}},[e._v(e._s(e.formData.remark))])],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(l,c,!1,function(e){a("OFCw")},"data-v-3fe9b148",null);t.default=d.exports},OFCw:function(e,t){}});
//# sourceMappingURL=34.d8f145e5f9d87f3d25ae.js.map