webpackJsonp([14],{HIBK:function(t,a){},OkrE:function(t,a){},gRQI:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("Xxa5"),i=e.n(s),r=e("exGp"),o=e.n(r),l=e("gyMJ"),n={data:function(){return{formData:{user_name:"",real_name:"",password:"",mobile:"",main_account:!1,disabled:!0},public_school_status:!1,civil_school_status:!1,primary_school_status:!1,junior_middle_school_status:!1,kindergarten_status:!1,main_account:!1,disabled:!0,listId:"",total:0,curr:1,hash:"",tableHeight:window.innerHeight-180,operation:!1,pageSize:15,method_auth:{actAdd:0,actEdit:0,actDelete:0,setState:0},main_auth:0,dialogPhoneVal:"",dialogNameVal:"",dialogpasswordVal:"",title:"",isLoading:!1,dialogVisible:!1,switchVal:!0,department_id:"",rule:{user_name:[{required:!0,message:"请输入登录手机号码",trigger:"blur"},{required:!0,pattern:/^1\d{10}$/,message:"手机号格式错误",trigger:"blur"}],real_name:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 20 个字符",trigger:"blur"},{required:!0,pattern:/^[\u4e00-\u9fa5_a-zA-Z.·-]+$/,message:"姓名不支持特殊字符",trigger:"blur"}],password:[{min:8,message:"密码必须大于8位",trigger:"blur"}]},tableHead:[{title:"编号",prop:"id",width:"100"},{title:"登录账号",prop:"user_name",minwidth:"150"},{title:"姓名",prop:"real_name",minwidth:"100"},{title:"手机号",prop:"mobile",minwidth:"150"},{title:"状态",prop:"disabled"}],tableData:[],nodeData:[],infoData:[],hasNodes:[],defaultProps:{children:"children",label:"node_name",disabled:"defaulted"}}},mounted:function(){this.getList(),this.getHash()},methods:{handleSizeChange:function(t){this.curr=1,this.pageSize=t,this.getList()},handleCurrentChange:function(t){this.curr=t,this.getList()},submitForm:function(t){var a,e=this;this.$refs[t].validate((a=o()(i.a.mark(function t(a){var s,r,o;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=11;break}return 1==e.formData.disabled?e.disabled=0:e.disabled=1,s={user_name:e.formData.user_name,password:e.formData.password,mobile:e.formData.mobile,real_name:e.formData.real_name,node_ids:e.$refs.tree.getCheckedKeys().concat(e.$refs.tree.getHalfCheckedKeys()).join(","),disabled:e.disabled,hash:e.hash},"新增"==e.title?r=l._54:"编辑"==e.title&&(r=l._56,s.id=e.listId),t.next=6,e.axios.post(r,s);case 6:1==(o=t.sent).data.code?(e.dialogVisible=!1,e.getList()):e.$message({showClose:!0,message:o.data.msg,type:"error"}),e.getHash(),t.next=13;break;case 11:return console.log("error submit!!"),t.abrupt("return",!1);case 13:case"end":return t.stop()}},t,e)})),function(t){return a.apply(this,arguments)}))},delBtn:function(t){var a=this;return o()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.$confirm("是否删除该条数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(o()(i.a.mark(function e(){var s,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s={id:t,deleted:1},e.next=3,a.axios.post(l._55,s);case 3:1==(r=e.sent).data.code?((a.total-1)%a.pageSize==0&&(a.curr=a.curr-1),a.$nextTick(function(){a.getList()})):a.$message({showClose:!0,message:r.data.msg,type:"error"}),a.getHash();case 6:case"end":return e.stop()}},e,a)}))).catch(function(){a.$message({type:"info",message:"已取消删除"})});case 1:case"end":return e.stop()}},e,a)}))()},addBtn:function(){var t=this;this.title="新增",this.dialogVisible=!0,this.$nextTick(function(){t.resetForm(),t.$refs.formData.clearValidate()}),this.getNodeData(),this.getHash()},resetForm:function(){this.formData={user_name:"",real_name:"",password:"",mobile:"",main_account:!1,disabled:!0},this.nodeData=[]},editBtn:function(t){var a=this;this.title="编辑",this.dialogVisible=!0,this.$nextTick(function(){a.resetForm(),a.$refs.formData.clearValidate()}),this.getInfoData(t.id),this.getHash()},switchChange:function(t,a,e,s){var r=this;return o()(i.a.mark(function o(){var n,d,c,u;return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n=1==e?1:0,"disabled"==a&&(n=0==e?1:0,d=l._59),c={id:t,state:n},i.next=5,r.axios.post(d,c);case 5:1==(u=i.sent).data.code||(r.tableData[s][a]=!e,r.$message({showClose:!0,message:u.data.msg,type:"error"}));case 7:case"end":return i.stop()}},o,r)}))()},handleClose:function(){this.dialogVisible=!1},getHash:function(){var t=this;return o()(i.a.mark(function a(){var e,s;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e={page_hash:"cityManage"},a.next=3,t.axios.post(l._20,e);case 3:1==(s=a.sent).data.code?t.hash=s.data.data:t.$message({showClose:!0,message:s.data.msg,type:"error"});case 5:case"end":return a.stop()}},a,t)}))()},getNodeData:function(t){var a=this;return o()(i.a.mark(function e(){var s,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.nodeData=[],e.next=3,a.axios.post(l._60);case 3:1==(s=e.sent).data.code?(a.nodeData=s.data.data,t&&"编辑"==a.title?a.$nextTick(function(){var a=this;this.$refs.tree.setCheckedKeys([]),t.forEach(function(t){var e=a.$refs.tree.getNode(t);e&&e.isLeaf&&a.$refs.tree.setChecked(e,!0)})}):(r=[],a.nodeData.forEach(function(t){r.push(t.id),t.children&&t.children.forEach(function(t){r.push(t.id)})}),a.$nextTick(function(){this.$refs.tree.setCheckedKeys(r)}))):a.$message({showClose:!0,message:s.data.msg,type:"error"});case 5:case"end":return e.stop()}},e,a)}))()},getInfoData:function(t){var a=this;return o()(i.a.mark(function e(){var s,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.infoData=[],s={id:t},e.next=4,a.axios.post(l._57,s);case 4:1==(r=e.sent).data.code?(a.infoData=r.data.data,a.hasNodes=r.data.data.nodes,a.getNodeData(a.hasNodes),a.operation=r.data.data.operation,a.listId=r.data.data.id,a.formData.user_name=r.data.data.user_name,a.formData.real_name=r.data.data.real_name,a.formData.mobile=r.data.data.mobile,1==r.data.data.disabled?a.formData.disabled=!1:a.formData.disabled=!0,1==r.data.data.main_account?a.formData.main_account=!0:a.formData.main_account=!1,a.formData.password=""):a.$message({showClose:!0,message:r.data.msg,type:"error"});case 6:case"end":return e.stop()}},e,a)}))()},getList:function(){var t=this;return o()(i.a.mark(function a(){var e,s,r;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.isLoading=!0,a.next=3,t.axios.post(l._58,{curr:t.curr,pagesize:t.pageSize});case 3:1==(e=a.sent).data.code?(t.tableData=e.data.data.data,t.total=e.data.data.total,t.main_auth=e.data.data.resources.main_auth.main_account,s=e.data.data.resources,r=t.method_auth,s.method_auth.map(function(t){t.method_name&&(r[t.method_name]=t.exist)}),t.method_auth=r,t.isLoading=!1):(t.isLoading=!1,t.$message({showClose:!0,message:e.data.msg,type:"error"}));case 5:case"end":return a.stop()}},a,t)}))()}}},d={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"main"},[e("div",{staticClass:"districtAccount"},[e("div",{staticClass:"searchA"},[e("div",{staticClass:"add"},[e("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus",disabled:!t.method_auth.actAdd},on:{click:function(a){return t.addBtn()}}},[t._v("新增")])],1)]),t._v(" "),e("div",{staticClass:"home_table"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",size:"medium","element-loading-background":"rgba(0, 0, 0, 0.4)","max-height":t.tableHeight}},[t._l(t.tableHead,function(a,s){return["状态"==a.title?e("el-table-column",{key:s,attrs:{prop:a.prop,label:a.title,width:"100"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-switch",{attrs:{disabled:!t.method_auth.setState&&!t.main_auth&&t.tableData[s.$index][a.prop]||s.row.operation},on:{change:function(e){return t.switchChange(s.row.id,a.prop,t.tableData[s.$index][a.prop],s.$index)}},model:{value:t.tableData[s.$index][a.prop],callback:function(e){t.$set(t.tableData[s.$index],a.prop,e)},expression:"tableData[scope.$index][item.prop]"}})]}}],null,!0)}):e("el-table-column",{key:s,attrs:{prop:a.prop,label:a.title,width:a.width,"min-width":a.minwidth}})]}),t._v(" "),e("el-table-column",{attrs:{prop:"address",label:"操作",fixed:"right",width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{disabled:!t.method_auth.actEdit,type:"text",size:"small"},on:{click:function(e){return t.editBtn(a.row)}}},[t._v("编辑")]),t._v(" "),e("el-button",{staticStyle:{color:"#ff2b2b"},attrs:{disabled:!t.method_auth.actDelete,type:"text",size:"small"},on:{click:function(e){return t.delBtn(a.row.id)}}},[t._v("删除")])]}}])})],2)],1),t._v(" "),e("div",{staticClass:"pagination"},[e("el-pagination",{staticClass:"pagination",attrs:{background:"","current-page":t.curr,"page-sizes":[15,30,50,100],"page-size":t.pageSize,layout:"prev, pager, next, sizes, total",total:t.total,"hide-on-single-page":t.total<15},on:{"update:currentPage":function(a){t.curr=a},"update:current-page":function(a){t.curr=a},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),e("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"dialogStyle",attrs:{title:t.title,visible:t.dialogVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(a){t.dialogVisible=a},close:function(a){return t.handleClose("formData")}}},[e("div",[e("el-form",{ref:"formData",staticClass:"demo-ruleForm",attrs:{model:t.formData,rules:t.rule}},[e("div",{staticClass:"dialogInput",staticStyle:{display:"flex"}},[e("div",{staticClass:"padd",staticStyle:{"margin-right":"10px"}},[e("el-form-item",{attrs:{label:"登录账号",prop:"user_name"}},[e("el-input",{attrs:{placeholder:"请输入登录手机号码",clearable:"",size:"small",maxlength:"11"},model:{value:t.formData.user_name,callback:function(a){t.$set(t.formData,"user_name",a)},expression:"formData.user_name"}})],1)],1),t._v(" "),e("div",{staticClass:"padd"},[e("el-form-item",{attrs:{label:"姓名",prop:"real_name"}},[e("el-input",{attrs:{placeholder:"请输入姓名",clearable:"",size:"small"},model:{value:t.formData.real_name,callback:function(a){t.$set(t.formData,"real_name",a)},expression:"formData.real_name"}})],1)],1)]),t._v(" "),e("div",{staticClass:"dialogInput",staticStyle:{display:"flex"}},[e("div",{staticClass:"padd",staticStyle:{"margin-right":"10px"}},[e("el-form-item",{attrs:{label:"手机号"}},[e("el-input",{attrs:{placeholder:"微信/i襄阳注册手机号",clearable:"",size:"small"},model:{value:t.formData.mobile,callback:function(a){t.$set(t.formData,"mobile",a)},expression:"formData.mobile"}})],1)],1),t._v(" "),e("div",{staticClass:"padd"},["新增"==t.title?e("el-form-item",{attrs:{label:"密码",prop:"password"}},[e("el-input",{attrs:{type:"password",placeholder:"请输入密码",clearable:"",size:"small"},model:{value:t.formData.password,callback:function(a){t.$set(t.formData,"password",a)},expression:"formData.password"}})],1):e("el-form-item",{attrs:{label:"密码"}},[e("el-input",{attrs:{type:"password",placeholder:"不修改请留空",clearable:"",size:"small"},model:{value:t.formData.password,callback:function(a){t.$set(t.formData,"password",a)},expression:"formData.password"}})],1)],1)]),t._v(" "),e("div",{staticClass:"dialogInput",staticStyle:{display:"flex"}},[e("div",{staticClass:"padd",staticStyle:{"margin-right":"10px"}},[e("el-form-item",{attrs:{prop:"public_school_status",label:"公办权限"}},[e("el-switch",{attrs:{disabled:!t.method_auth.publicState||!t.status_auth.public_school_status},model:{value:t.formData.public_school_status,callback:function(a){t.$set(t.formData,"public_school_status",a)},expression:"formData.public_school_status"}})],1)],1),t._v(" "),e("div",{staticClass:"padd",staticStyle:{"margin-right":"10px"}},[e("el-form-item",{attrs:{prop:"civil_school_status",label:"民办权限"}},[e("el-switch",{attrs:{disabled:!t.method_auth.civilState||!t.status_auth.civil_school_status},model:{value:t.formData.civil_school_status,callback:function(a){t.$set(t.formData,"civil_school_status",a)},expression:"formData.civil_school_status"}})],1)],1)]),t._v(" "),e("div",{staticClass:"dialogInput",staticStyle:{display:"flex"}},[e("div",{staticClass:"padd",staticStyle:{"margin-right":"10px"}},[e("el-form-item",{attrs:{prop:"primary_school_status",label:"小学权限"}},[e("el-switch",{attrs:{disabled:!t.method_auth.primaryState||!t.status_auth.primary_school_status},model:{value:t.formData.primary_school_status,callback:function(a){t.$set(t.formData,"primary_school_status",a)},expression:"formData.primary_school_status"}})],1)],1),t._v(" "),e("div",{staticClass:"padd",staticStyle:{"margin-right":"10px"}},[e("el-form-item",{attrs:{prop:"junior_middle_school_status",label:"初中权限"}},[e("el-switch",{attrs:{disabled:!t.method_auth.juniorState||!t.status_auth.junior_middle_school_status},model:{value:t.formData.junior_middle_school_status,callback:function(a){t.$set(t.formData,"junior_middle_school_status",a)},expression:"formData.junior_middle_school_status"}})],1)],1)]),t._v(" "),e("div",{staticClass:"dialogInput",staticStyle:{display:"flex"}},[e("div",{staticClass:"padd",staticStyle:{"margin-right":"10px"}},[e("el-form-item",{attrs:{prop:"kindergarten_status",label:"幼儿园权限"}},[e("el-switch",{attrs:{disabled:!t.method_auth.kindergartenState||!t.status_auth.kindergarten_status},model:{value:t.formData.kindergarten_status,callback:function(a){t.$set(t.formData,"kindergarten_status",a)},expression:"formData.kindergarten_status"}})],1)],1),t._v(" "),e("div",{staticClass:"padd",staticStyle:{"margin-right":"10px"}},[e("el-form-item",{attrs:{prop:"disabled",label:"状态"}},[e("el-switch",{attrs:{disabled:!t.method_auth.setState&&!t.main_auth&&t.formData.main_account||this.operation},model:{value:t.formData.disabled,callback:function(a){t.$set(t.formData,"disabled",a)},expression:"formData.disabled"}})],1)],1)]),t._v(" "),e("div",{staticClass:"dialogInput"},[e("div",{staticClass:"padd"},[e("div",{staticClass:"paddTit"},[t._v("资源权限")]),t._v(" "),e("div",{staticClass:"tree_main"},[e("el-form-item",[e("el-tree",{ref:"tree",attrs:{data:t.nodeData,"show-checkbox":"","check-on-click-node":"","node-key":"id","default-expand-all":"",props:t.defaultProps}})],1)],1)])]),t._v(" "),e("div",{staticStyle:{"text-align":"center"}},[e("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:function(a){return t.submitForm("formData")}}},[t._v("确 定")])],1)])],1)])],1)])},staticRenderFns:[]};var c=e("VU/8")(n,d,!1,function(t){e("HIBK"),e("OkrE")},"data-v-78eeb8ac",null);a.default=c.exports}});
//# sourceMappingURL=14.dfb340f175df7e33a263.js.map