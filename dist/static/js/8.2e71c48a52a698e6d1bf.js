webpackJsonp([8],{"9czF":function(a,t){},cuPU:function(a,t){},pM0m:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=e("Xxa5"),i=e.n(s),r=e("exGp"),n=e.n(r),o=e("gyMJ"),l={filters:{disFilter:function(a){return{false:"danger",true:"primary"}[a]}},data:function(){return{formData:{user_name:"",real_name:"",password:"",mobile:"",main_account:!1,disabled:!0},main_account:!1,disabled:!0,listId:"",total:0,curr:1,hash:"",tableHeight:window.innerHeight-180,pageSize:15,options1:[],method_auth:{actAdd:0,actEdit:0,actDelete:0},main_auth:0,dialogPhoneVal:"",dialogNameVal:"",dialogpasswordVal:"",title:"",isLoading:!1,dialogVisible:!1,switchVal:!0,department_id:"",rule:{user_name:[{required:!0,message:"请输入登录手机号码",trigger:"blur"},{required:!0,pattern:/^1\d{10}$/,message:"手机号格式错误",trigger:"blur"}],real_name:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 20 个字符",trigger:"blur"},{required:!0,pattern:/^[\u4e00-\u9fa5_a-zA-Z.·-]+$/,message:"姓名不支持特殊字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:8,message:"密码必须大于8位",trigger:"blur"}],selectVal1:[{required:!0,message:"请选中活动区域",trigger:"blur"}]},tableHead:[{title:"编号",prop:"id",width:"100"},{title:"登录账号",prop:"user_name",minwidth:"150"},{title:"姓名",prop:"real_name",minwidth:"100"},{title:"手机号",prop:"mobile",minwidth:"150"},{title:"状态",prop:"disabled"}],tableData:[],nodeData:[],infoData:[],hasNodes:[],defaultProps:{children:"children",label:"node_name",disabled:"defaulted"}}},mounted:function(){this.getList(),this.getHash()},methods:{handleSizeChange:function(a){console.log(a),this.curr=1,this.pageSize=a,this.getList()},handleCurrentChange:function(a){this.curr=a,this.getList()},submitForm:function(a){var t,e=this;this.$refs[a].validate((t=n()(i.a.mark(function a(t){var s,r,n;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!t){a.next=12;break}return 1==e.formData.disabled?e.disabled=0:e.disabled=1,1==e.formData.main_account?e.main_account=1:e.main_account=0,s={user_name:e.formData.user_name,password:e.formData.password,mobile:e.formData.mobile,real_name:e.formData.real_name,node_ids:e.$refs.tree.getCheckedKeys().concat(e.$refs.tree.getHalfCheckedKeys()).join(","),disabled:e.disabled,main_account:e.main_account,hash:e.hash},"新增"==e.title?r=o.a:"编辑"==e.title&&(r=o.c,s.id=e.listId),a.next=7,e.axios.post(r,s);case 7:1==(n=a.sent).data.code?(e.dialogVisible=!1,e.getList()):e.$message({showClose:!0,message:n.data.msg,type:"error"}),e.getHash(),a.next=14;break;case 12:return console.log("error submit!!"),a.abrupt("return",!1);case 14:case"end":return a.stop()}},a,e)})),function(a){return t.apply(this,arguments)}))},delBtn:function(a){var t=this;return n()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.$confirm("是否删除该条数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(n()(i.a.mark(function e(){var s,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s={id:a,deleted:1},e.next=3,t.axios.post(o.b,s);case 3:1==(r=e.sent).data.code?((t.total-1)%t.pageSize==0&&(t.curr=t.curr-1),t.$nextTick(function(){t.getList()})):t.$message({showClose:!0,message:r.data.msg,type:"error"}),t.getHash();case 6:case"end":return e.stop()}},e,t)}))).catch(function(){t.$message({type:"info",message:"已取消删除"})});case 1:case"end":return e.stop()}},e,t)}))()},addBtn:function(){var a=this;this.title="新增",this.dialogVisible=!0,this.$nextTick(function(){a.resetForm(),a.$refs.formData.clearValidate()}),this.getNodeData(),this.getHash()},resetForm:function(){this.formData={user_name:"",real_name:"",password:"",mobile:"",main_account:!1,disabled:!0},this.nodeData=[]},editBtn:function(a){var t=this;this.title="编辑",this.dialogVisible=!0,this.$nextTick(function(){t.resetForm(),t.$refs.formData.clearValidate()}),this.getInfoData(a.id),this.getHash()},getHash:function(){var a=this;return n()(i.a.mark(function t(){var e,s;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={page_hash:"adminAccount"},t.next=3,a.axios.post(o._20,e);case 3:1==(s=t.sent).data.code?a.hash=s.data.data:a.$message({showClose:!0,message:s.data.msg,type:"error"});case 5:case"end":return t.stop()}},t,a)}))()},handleClose:function(){this.dialogVisible=!1},getNodeData:function(a){var t=this;return n()(i.a.mark(function e(){var s,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.nodeData=[],e.next=3,t.axios.post(o.f);case 3:1==(s=e.sent).data.code?(t.nodeData=s.data.data,a&&"编辑"==t.title?t.$nextTick(function(){var t=this;this.$refs.tree.setCheckedKeys([]),a.forEach(function(a){var e=t.$refs.tree.getNode(a);e&&e.isLeaf&&t.$refs.tree.setChecked(e,!0)})}):(r=[],t.nodeData.forEach(function(a){r.push(a.id),a.children&&a.children.forEach(function(a){r.push(a.id)})}),t.$nextTick(function(){this.$refs.tree.setCheckedKeys(r)}))):t.$message({showClose:!0,message:s.data.msg,type:"error"});case 5:case"end":return e.stop()}},e,t)}))()},getInfoData:function(a){var t=this;return n()(i.a.mark(function e(){var s,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.infoData=[],s={id:a},e.next=4,t.axios.post(o.d,s);case 4:1==(r=e.sent).data.code?(t.infoData=r.data.data,t.hasNodes=r.data.data.nodes,t.getNodeData(t.hasNodes),t.listId=r.data.data.id,t.formData.user_name=r.data.data.user_name,t.formData.real_name=r.data.data.real_name,t.formData.mobile=r.data.data.mobile,1==r.data.data.disabled?t.formData.disabled=!1:t.formData.disabled=!0,1==r.data.data.main_account?t.formData.main_account=!0:t.formData.main_account=!1,t.formData.password=""):t.$message({showClose:!0,message:r.data.msg,type:"error"});case 6:case"end":return e.stop()}},e,t)}))()},getList:function(){var a=this;return n()(i.a.mark(function t(){var e,s,r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.isLoading=!0,t.next=3,a.axios.post(o.e,{curr:a.curr,pagesize:a.pageSize});case 3:1==(e=t.sent).data.code?(a.tableData=e.data.data.data,a.total=e.data.data.total,s=e.data.data.resources.method_auth,r=a.method_auth,a.main_auth=e.data.data.resources.main_auth.main_account,s.map(function(a){a.method_name&&(r[a.method_name]=a.exist)}),a.method_auth=r,a.isLoading=!1):(a.isLoading=!1,a.$message({showClose:!0,message:e.data.msg,type:"error"}));case 5:case"end":return t.stop()}},t,a)}))()}}},d={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"main"},[e("div",{staticClass:"districtAccount"},[e("div",{staticClass:"searchA"},[e("div",{staticClass:"add"},[e("el-button",{directives:[{name:"show",rawName:"v-show",value:a.method_auth.actAdd,expression:"method_auth.actAdd"}],attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return a.addBtn()}}},[a._v("新增")])],1)]),a._v(" "),e("div",{staticClass:"home_table"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.isLoading,expression:"isLoading"}],staticStyle:{width:"100%"},attrs:{data:a.tableData,border:"","element-loading-background":"rgba(0, 0, 0, 0.4)","max-height":a.tableHeight,size:"medium"}},[a._l(a.tableHead,function(t,s){return["状态"==t.title?e("el-table-column",{key:s,attrs:{prop:t.prop,label:t.title,width:"90"},scopedSlots:a._u([{key:"default",fn:function(s){return[e("el-tag",{attrs:{size:"small",type:a._f("disFilter")(a.tableData[s.$index][t.prop])}},[1==a.tableData[s.$index][t.prop]?e("span",[a._v("启用")]):e("span",[a._v("禁用")])])]}}],null,!0)}):e("el-table-column",{key:s,attrs:{prop:t.prop,label:t.title,width:t.width,"min-width":t.minwidth,"show-overflow-tooltip":!0}})]}),a._v(" "),e("el-table-column",{attrs:{prop:"address",label:"操作",fixed:"right",width:"150"},scopedSlots:a._u([{key:"default",fn:function(t){return[e("el-button",{attrs:{disabled:!a.method_auth.actEdit,type:"text",size:"small"},on:{click:function(e){return a.editBtn(t.row)}}},[a._v("编辑")]),a._v(" "),e("el-button",{staticStyle:{color:"#ff2b2b"},attrs:{disabled:!a.method_auth.actDelete,type:"text",size:"small"},on:{click:function(e){return a.delBtn(t.row.id)}}},[a._v("删除")])]}}])})],2)],1),a._v(" "),e("div",{staticClass:"pagination"},[e("el-pagination",{staticClass:"pagination",attrs:{background:"","current-page":a.curr,"page-sizes":[15,30,50,100],"page-size":a.pageSize,layout:"prev, pager, next, sizes, total",total:a.total,"hide-on-single-page":a.total<15},on:{"update:currentPage":function(t){a.curr=t},"update:current-page":function(t){a.curr=t},"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1),a._v(" "),e("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"dialogStyle",attrs:{title:a.title,visible:a.dialogVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){a.dialogVisible=t},close:function(t){return a.handleClose("formData")}}},[e("div",[e("el-form",{ref:"formData",staticClass:"demo-ruleForm",attrs:{model:a.formData,rules:a.rule}},[e("div",{staticClass:"dialogInput",staticStyle:{display:"flex"}},[e("div",{staticClass:"padd",staticStyle:{"margin-right":"10px"}},[e("el-form-item",{attrs:{label:"登录账号",prop:"user_name"}},[e("el-input",{attrs:{placeholder:"请输入登录手机号码",clearable:"",size:"small",maxlength:"11"},model:{value:a.formData.user_name,callback:function(t){a.$set(a.formData,"user_name",t)},expression:"formData.user_name"}})],1)],1),a._v(" "),e("div",{staticClass:"padd"},[e("el-form-item",{attrs:{label:"姓名",prop:"real_name"}},[e("el-input",{attrs:{placeholder:"请输入姓名",clearable:"",size:"small"},model:{value:a.formData.real_name,callback:function(t){a.$set(a.formData,"real_name",t)},expression:"formData.real_name"}})],1)],1)]),a._v(" "),e("div",{staticClass:"dialogInput",staticStyle:{display:"flex"}},[e("div",{staticClass:"padd",staticStyle:{"margin-right":"10px"}},[e("el-form-item",{attrs:{label:"手机号"}},[e("el-input",{attrs:{placeholder:"微信/i襄阳注册手机号",clearable:"",size:"small"},model:{value:a.formData.mobile,callback:function(t){a.$set(a.formData,"mobile",t)},expression:"formData.mobile"}})],1)],1),a._v(" "),e("div",{staticClass:"padd"},["新增"==a.title?e("el-form-item",{attrs:{label:"密码",prop:"password"}},[e("el-input",{attrs:{type:"password",placeholder:"请输入密码",clearable:"",size:"small"},model:{value:a.formData.password,callback:function(t){a.$set(a.formData,"password",t)},expression:"formData.password"}})],1):e("el-form-item",{attrs:{label:"密码"}},[e("el-input",{attrs:{type:"password",placeholder:"无需修改请留空",clearable:"",size:"small"},model:{value:a.formData.password,callback:function(t){a.$set(a.formData,"password",t)},expression:"formData.password"}})],1)],1)]),a._v(" "),e("div",{staticClass:"dialogInput",staticStyle:{display:"flex"}},[e("div",{staticClass:"padd",staticStyle:{"margin-right":"10px"}},[e("el-form-item",{attrs:{prop:"main_account",label:"负责人权限"}},[e("el-switch",{attrs:{disabled:!a.main_auth},model:{value:a.formData.main_account,callback:function(t){a.$set(a.formData,"main_account",t)},expression:"formData.main_account"}})],1)],1),a._v(" "),e("div",{staticClass:"padd",staticStyle:{"margin-right":"10px"}},[e("el-form-item",{attrs:{prop:"disabled",label:"状态"}},[e("el-switch",{attrs:{disabled:!a.main_auth&&a.formData.main_account},model:{value:a.formData.disabled,callback:function(t){a.$set(a.formData,"disabled",t)},expression:"formData.disabled"}})],1)],1)]),a._v(" "),e("div",{staticClass:"dialogInput"},[e("div",{staticClass:"padd"},[e("div",{staticClass:"paddTit"},[a._v("功能节点")]),a._v(" "),e("div",{staticClass:"tree_main"},[e("el-form-item",[e("el-tree",{ref:"tree",attrs:{data:a.nodeData,"show-checkbox":"","check-on-click-node":"","node-key":"id","default-expand-all":"",props:a.defaultProps}})],1)],1)])]),a._v(" "),e("div",{staticStyle:{"text-align":"center"}},[e("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:function(t){return a.submitForm("formData")}}},[a._v("确 定")])],1)])],1)])],1)])},staticRenderFns:[]};var c=e("VU/8")(l,d,!1,function(a){e("9czF"),e("cuPU")},"data-v-d7c9072a",null);t.default=c.exports}});
//# sourceMappingURL=8.2e71c48a52a698e6d1bf.js.map