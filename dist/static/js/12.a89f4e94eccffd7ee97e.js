webpackJsonp([12],{LlGu:function(a,t){},Lo8v:function(a,t){},y0wh:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=e("Xxa5"),i=e.n(s),r=e("exGp"),n=e.n(r),o=e("gyMJ"),l={data:function(){return{formData:{user_name:"",real_name:"",password:"",mobile:"",department_id:"",selectVal1:"",main_account:!0,disabled:!0},method_auth:{actAdd:0,actEdit:0,actDelete:0,setState:0},main_account:!0,disabled:!0,isCity:0,main_auth:0,tableHeight:window.innerHeight-180,listId:"",total:0,curr:1,region_id:"",keyword:"",hash:"",pageSize:15,departmentData:[],regionData:[],title:"",isLoading:!1,dialogVisible:!1,switchVal:!0,rule:{user_name:[{required:!0,message:"请输入登录手机号码",trigger:"blur"},{required:!0,pattern:/^1\d{10}$/,message:"手机号格式错误",trigger:"blur"}],real_name:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:24,message:"姓名长度在 2 到 24 个字符",trigger:"blur"},{required:!0,pattern:/^[\u4e00-\u9fa5_a-zA-Z.·]+$/,message:"姓名不支持特殊字符",trigger:"blur"}],selectVal1:[{required:!0,message:"请选择部门",trigger:"change"}]},tableHead:[{title:"编号",prop:"id",width:"100"},{title:"部门",prop:"department_name",minwidth:"180"},{title:"登录账号",prop:"user_name",minwidth:"150"},{title:"姓名",prop:"real_name",minwidth:"100"},{title:"手机号",prop:"mobile",minwidth:"150"},{title:"状态",prop:"disabled"}],tableData:[],nodeData:[],infoData:[],hasNodes:[],defaultProps:{children:"children",label:"node_name",disabled:"defaulted"}}},mounted:function(){this.getList(),this.getNodeData(),this.getHash()},methods:{handleSizeChange:function(a){this.curr=1,this.pageSize=a,this.getList()},handleCurrentChange:function(a){this.curr=a,this.getList()},submitForm:function(a){var t,e=this;this.$refs[a].validate((t=n()(i.a.mark(function a(t){var s,r,n,l,d;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!t){a.next=12;break}return s=1==e.formData.main_account?1:0,r=1==e.formData.disabled?0:1,n={user_name:e.formData.user_name,password:e.formData.password,mobile:e.formData.mobile,real_name:e.formData.real_name,department_id:e.formData.department_id,main_account:s,disabled:r,node_ids:e.$refs.tree.getCheckedKeys().concat(e.$refs.tree.getHalfCheckedKeys()).join(","),hash:e.hash},"新增"==e.title?l=o.k:"编辑"==e.title&&(l=o.m,n.id=e.listId),a.next=7,e.axios.post(l,n);case 7:1==(d=a.sent).data.code?(e.dialogVisible=!1,e.$message({showClose:!0,message:d.data.msg,type:"success"}),e.getList()):e.$message({showClose:!0,message:d.data.msg,type:"error"}),e.getHash(),a.next=14;break;case 12:return console.log("error submit!!"),a.abrupt("return",!1);case 14:case"end":return a.stop()}},a,e)})),function(a){return t.apply(this,arguments)}))},getNodeData:function(a){var t=this;return n()(i.a.mark(function e(){var s,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.nodeData=[],e.next=3,t.axios.post(o.q);case 3:1==(s=e.sent).data.code?(t.departmentData=s.data.data.department,t.regionData=s.data.data.region,t.nodeData=s.data.data.nodes,a&&"编辑"==t.title?t.$nextTick(function(){var t=this;this.$refs.tree.setCheckedKeys([]),a.forEach(function(a){var e=t.$refs.tree.getNode(a);e&&e.isLeaf&&t.$refs.tree.setChecked(e,!0)})}):"新增"==t.title&&(r=[],t.nodeData.forEach(function(a){r.push(a.id),a.children&&a.children.forEach(function(a){r.push(a.id)})}),t.$nextTick(function(){this.$refs.tree.setCheckedKeys(r)}))):t.$message({showClose:!0,message:s.data.msg,type:"error"});case 5:case"end":return e.stop()}},e,t)}))()},getInfoData:function(a){var t=this;return n()(i.a.mark(function e(){var s,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.infoData=[],s={id:a},e.next=4,t.axios.post(o.n,s);case 4:1==(r=e.sent).data.code?(t.infoData=r.data.data,t.hasNodes=r.data.data.nodes,t.getNodeData(t.hasNodes),t.listId=r.data.data.id,t.formData.user_name=r.data.data.user_name,t.formData.real_name=r.data.data.real_name,t.formData.mobile=r.data.data.mobile,t.formData.department_id=r.data.data.department_id,t.formData.password="",1==r.data.data.disabled?t.formData.disabled=!1:t.formData.disabled=!0,1==r.data.data.main_account?t.formData.main_account=!0:t.formData.main_account=!1,t.formData.selectVal1=r.data.data.department_id):t.$message({showClose:!0,message:r.data.msg,type:"error"});case 6:case"end":return e.stop()}},e,t)}))()},delBtn:function(a){var t=this;return n()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.$confirm("是否删除该条数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(n()(i.a.mark(function e(){var s,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s={id:a,deleted:1},e.next=3,t.axios.post(o.l,s);case 3:1==(r=e.sent).data.code?((t.total-1)%t.pageSize==0&&t.total>1&&(t.curr-=1),t.$nextTick(function(){t.getList()})):t.$message({showClose:!0,message:r.data.msg,type:"error"}),t.getHash();case 6:case"end":return e.stop()}},e,t)}))).catch(function(){t.$message({type:"info",message:"已取消删除"})});case 1:case"end":return e.stop()}},e,t)}))()},addBtn:function(){var a=this;this.title="新增",this.dialogVisible=!0,this.$nextTick(function(){a.resetForm()}),this.getNodeData(),this.getHash()},editBtn:function(a){var t=this;this.title="编辑",this.dialogVisible=!0,this.$nextTick(function(){t.$refs.formData.clearValidate()}),this.getInfoData(a.id),this.getHash()},resetForm:function(){var a=this;this.formData={user_name:"",real_name:"",password:"",mobile:"",selectVal1:"",main_account:!0,disabled:!0},this.nodeData=[],this.$nextTick(function(){a.$refs.formData.clearValidate()})},handleClose:function(a){this.dialogVisible=!1},getHash:function(){var a=this;return n()(i.a.mark(function t(){var e,s;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={page_hash:"areaAccount"},t.next=3,a.axios.post(o._20,e);case 3:1==(s=t.sent).data.code?a.hash=s.data.data:a.$message({showClose:!0,message:s.data.msg,type:"error"});case 5:case"end":return t.stop()}},t,a)}))()},switchChange:function(a,t,e,s){var r=this;return n()(i.a.mark(function n(){var l,d,c,u;return i.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return l=1==e?1:0,"disabled"==t&&(l=0==e?1:0,d=o.p),c={id:a,state:l},i.next=5,r.axios.post(d,c);case 5:1==(u=i.sent).data.code?console.log("成功"):(r.tableData[s][t]=!e,r.$message({showClose:!0,message:u.data.msg,type:"error"}));case 7:case"end":return i.stop()}},n,r)}))()},quvSelectChange:function(a){this.formData.department_id=a},getList:function(a){var t=this;return n()(i.a.mark(function e(){var s,r,n,l;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a&&(t.curr=1),s={region_id:t.region_id,keyword:t.keyword,curr:t.curr,pagesize:t.pageSize},t.isLoading=!0,e.next=5,t.axios.post(o.o,s);case 5:1==(r=e.sent).data.code?(t.tableData=r.data.data.data,t.total=r.data.data.total,n=r.data.data.resources,l=t.method_auth,t.isCity=r.data.data.resources.grade_auth.grade_status,t.main_auth=r.data.data.resources.main_auth.main_account,n.method_auth.map(function(a){a.method_name&&(l[a.method_name]=a.exist)}),t.method_auth=l,t.isLoading=!1):(t.isLoading=!1,t.$message({showClose:!0,message:r.data.msg,type:"error"}));case 7:case"end":return e.stop()}},e,t)}))()}}},d={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"main"},[e("div",{staticClass:"districtAccount"},[e("div",{staticClass:"searchA"},[e("el-select",{directives:[{name:"show",rawName:"v-show",value:!a.isCity,expression:"!isCity"}],staticStyle:{"margin-right":"20px"},attrs:{clearable:"",placeholder:"请选择区县",size:"small"},model:{value:a.region_id,callback:function(t){a.region_id=t},expression:"region_id"}},a._l(a.regionData,function(a){return e("el-option",{key:a.id,attrs:{label:a.region_name,value:a.id}})}),1),a._v(" "),e("div",{staticClass:"padd",staticStyle:{"margin-right":"20px"}},[e("el-input",{attrs:{placeholder:"请输入关键字、拼音",clearable:"",size:"small"},model:{value:a.keyword,callback:function(t){a.keyword=t},expression:"keyword"}})],1),a._v(" "),e("div",{staticClass:"padd",staticStyle:{"margin-right":"20px"}},[e("el-button",{attrs:{size:"small",type:"primary",plain:"",icon:"el-icon-search"},on:{click:function(t){return a.getList(1)}}},[a._v("查询")])],1),a._v(" "),e("div",{staticClass:"add"},[e("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus",disabled:!a.method_auth.actAdd},on:{click:function(t){return a.addBtn()}}},[a._v("新增")])],1)],1),a._v(" "),e("div",{staticClass:"home_table"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.isLoading,expression:"isLoading"}],staticStyle:{width:"100%"},attrs:{data:a.tableData,border:"","element-loading-background":"rgba(0, 0, 0, 0.4)","max-height":a.tableHeight,size:"medium"}},[a._l(a.tableHead,function(t,s){return["状态"==t.title?e("el-table-column",{key:s,attrs:{prop:t.prop,label:t.title,width:"100"},scopedSlots:a._u([{key:"default",fn:function(s){return[e("el-switch",{attrs:{disabled:!a.method_auth.setState},on:{change:function(e){return a.switchChange(s.row.id,t.prop,a.tableData[s.$index][t.prop],s.$index)}},model:{value:a.tableData[s.$index][t.prop],callback:function(e){a.$set(a.tableData[s.$index],t.prop,e)},expression:"tableData[scope.$index][item.prop]"}})]}}],null,!0)}):e("el-table-column",{key:s,attrs:{prop:t.prop,label:t.title,width:t.width,"min-width":t.minwidth,"show-overflow-tooltip":!0}})]}),a._v(" "),e("el-table-column",{attrs:{prop:"address",label:"操作",fixed:"right",width:"150"},scopedSlots:a._u([{key:"default",fn:function(t){return[e("el-button",{attrs:{type:"text",disabled:!a.method_auth.actEdit,size:"small"},on:{click:function(e){return a.editBtn(t.row)}}},[a._v("编辑")]),a._v(" "),e("el-button",{staticStyle:{color:"#ff2b2b"},attrs:{type:"text",disabled:!a.method_auth.actDelete,size:"small"},on:{click:function(e){return a.delBtn(t.row.id)}}},[a._v("删除")])]}}])})],2)],1),a._v(" "),e("div",{staticClass:"pagination"},[e("el-pagination",{staticClass:"pagination",attrs:{background:"","current-page":a.curr,"page-sizes":[15,30,50,100],"page-size":a.pageSize,layout:"prev, pager, next, sizes, total",total:a.total,"hide-on-single-page":a.total<15},on:{"update:currentPage":function(t){a.curr=t},"update:current-page":function(t){a.curr=t},"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}})],1),a._v(" "),e("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"dialogStyle",attrs:{title:a.title,visible:a.dialogVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){a.dialogVisible=t},close:function(t){return a.handleClose("formData")}}},[e("div",[e("el-form",{ref:"formData",staticClass:"demo-ruleForm",attrs:{model:a.formData,rules:a.rule}},[e("div",{staticClass:"dialogInput",staticStyle:{display:"flex"}},[e("div",{staticClass:"padd",staticStyle:{"margin-right":"10px"}},[e("el-form-item",{attrs:{label:"登录账号",prop:"user_name"}},[e("el-input",{attrs:{placeholder:"请输入登录手机号码",clearable:"",size:"small",maxlength:"11"},model:{value:a.formData.user_name,callback:function(t){a.$set(a.formData,"user_name",t)},expression:"formData.user_name"}})],1)],1),a._v(" "),e("div",{staticClass:"padd"},[e("el-form-item",{attrs:{label:"真实姓名",prop:"real_name"}},[e("el-input",{attrs:{placeholder:"请输入姓名",clearable:"",size:"small"},model:{value:a.formData.real_name,callback:function(t){a.$set(a.formData,"real_name",t)},expression:"formData.real_name"}})],1)],1)]),a._v(" "),e("div",{staticClass:"dialogInput",staticStyle:{display:"flex"}},[e("div",{staticClass:"padd",staticStyle:{"margin-right":"10px"}},[e("el-form-item",{attrs:{label:"手机号"}},[e("el-input",{attrs:{placeholder:"微信/i襄阳注册手机号",clearable:"",size:"small"},model:{value:a.formData.mobile,callback:function(t){a.$set(a.formData,"mobile",t)},expression:"formData.mobile"}})],1)],1),a._v(" "),e("div",{staticClass:"padd"},[e("el-form-item",{attrs:{label:"密码"}},[e("el-input",{attrs:{type:"password",placeholder:"请输入密码",clearable:"",size:"small"},model:{value:a.formData.password,callback:function(t){a.$set(a.formData,"password",t)},expression:"formData.password"}})],1)],1)]),a._v(" "),e("div",{staticClass:"dialogInput"},[e("div",{staticClass:"padd",staticStyle:{width:"275px"}},[e("div",{staticClass:"paddTit"},[a._v("部门")]),a._v(" "),e("div",[e("el-form-item",{attrs:{prop:"selectVal1"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择部门",size:"small"},on:{change:function(t){return a.quvSelectChange(a.formData.selectVal1)}},model:{value:a.formData.selectVal1,callback:function(t){a.$set(a.formData,"selectVal1",t)},expression:"formData.selectVal1"}},a._l(a.departmentData,function(a){return e("el-option",{key:a.id,attrs:{label:a.department_name,value:a.id}})}),1)],1)],1)])]),a._v(" "),e("div",{staticClass:"dialogInput",staticStyle:{display:"flex"}},[e("div",{staticClass:"padd",staticStyle:{"margin-right":"10px"}},[e("el-form-item",{attrs:{prop:"main_account",label:"负责人账号"}},[e("el-switch",{model:{value:a.formData.main_account,callback:function(t){a.$set(a.formData,"main_account",t)},expression:"formData.main_account"}})],1)],1),a._v(" "),e("div",{staticClass:"padd",staticStyle:{"margin-right":"10px"}},[e("el-form-item",{attrs:{prop:"disabled",label:"状态"}},[e("el-switch",{attrs:{disabled:!a.method_auth.setState},model:{value:a.formData.disabled,callback:function(t){a.$set(a.formData,"disabled",t)},expression:"formData.disabled"}})],1)],1)]),a._v(" "),e("div",{staticClass:"dialogInput"},[e("div",{staticClass:"padd"},[e("div",{staticClass:"paddTit"},[a._v("功能节点")]),a._v(" "),e("div",{staticClass:"tree_main"},[e("el-form-item",[e("el-tree",{ref:"tree",attrs:{data:a.nodeData,"show-checkbox":"","check-on-click-node":"","node-key":"id","default-expand-all":"",props:a.defaultProps}})],1)],1)])]),a._v(" "),e("div",{staticStyle:{"text-align":"center"}},[e("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:function(t){return a.submitForm("formData")}}},[a._v("确 定")])],1)])],1)])],1)])},staticRenderFns:[]};var c=e("VU/8")(l,d,!1,function(a){e("Lo8v"),e("LlGu")},"data-v-a31c5ff6",null);t.default=c.exports}});
//# sourceMappingURL=12.a89f4e94eccffd7ee97e.js.map