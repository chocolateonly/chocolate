webpackJsonp([43],{"2+As":function(e,t){},ENgT:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Xxa5"),s=a.n(i),r=a("exGp"),o=a.n(r),n=a("gyMJ"),l={data:function(){return{total:0,page:1,pageSize:15,tableHeight:window.innerHeight-180,inputWidth:"300px",dialogVisible:!1,dialogFormVisible:!1,title:"",search:{name:"",address:"",device_id:""},formData:{},equipment:[],tableHead:[{title:"序号",prop:"id",minWidth:"120"},{title:"设备类型",prop:"device_type_txt",minWidth:"150"},{title:"设备名称",prop:"device_name",minWidth:"220"},{title:"设备码",prop:"device_code",minWidth:"180"},{title:"设备所在位置",prop:"location_txt",minWidth:"200"},{title:"创建时间",prop:"create_time",minWidth:"180"},{title:"ip",prop:"ip_address",minWidth:"200"},{title:"状态",prop:"disabled",minWidth:"100"}],tableData:[],rule:{device_type:[{required:!0,message:"请选择设备类型",trigger:"change"}],device_name:[{required:!0,message:"请输入设备名称",trigger:"blur"}],device_code:[{required:!0,message:"请输入设备码",trigger:"blur"}],point_type:[{required:!0,message:"请选择点位类型",trigger:"change"}],relevancy_id:[{required:!0,message:"请选择关联视频设备",trigger:"change"}],lamp_device_id:[{required:!0,message:"请选择关联预警灯",trigger:"change"}],duty_position_id:[{required:!0,message:"请选择关联值班地点",trigger:"change"}],relevancy_device_type:[{required:!0,message:"请选择关联设备类型",trigger:"change"}]},deviceType:[],positionData:[],hash:"",deviceList:[],dutyStation:[],checked:!1,poinType:[],type:[{id:1,name:"电子班牌"},{id:2,name:"显示屏"}],warningLight:[]}},mounted:function(){this.getList(),this.getHash(),this.resView(),this.typeList()},methods:{typeChange:function(e){this.typeList(e)},serchList:function(){this.page=1,this.pageSize=15,this.getList()},statusChange:function(e,t){var a=this;return o()(s.a.mark(function i(){var r;return s.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,a.axios.post(n._6,{id:e.id,disabled:t?0:1});case 2:1==(r=i.sent).data.code?a.$message({showClose:!0,message:r.data.msg,type:"success"}):a.$message({showClose:!0,message:r.data.msg,type:"error"}),a.getList(),a.resView();case 6:case"end":return i.stop()}},i,a)}))()},nodeChange:function(e){this.formData.location_address=e},handleSizeChange:function(e){this.page=1,this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.page=e,this.getList()},add:function(){this.title="新增设备",this.checked=!1,this.dialogFormVisible=!0,this.resetForm()},editBtn:function(e){this.title="编辑设备",this.checked=!1,this.dialogFormVisible=!0,this.resetForm(),this.getInfo(e.id)},check:function(e){this.title="查看设备",this.checked=!0,this.dialogFormVisible=!0,this.resetForm(),this.getInfo(e.id)},resetForm:function(){var e=this;this.formData={device_type:"",device_name:"",device_code:"",point_type:"",relevancy_id:"",lamp_device_id:"",location_address:"",duty_position_id:"",ip_address:"",relevancy_device_type:""},this.$nextTick(function(){e.$refs.formData.resetFields()})},handleClose:function(){this.resetForm(),this.dialogFormVisible=!1},getInfo:function(e){var t=this;return o()(s.a.mark(function a(){var i;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.axios.post(n._8,{id:e});case 2:1==(i=a.sent).data.code?(i.data.data.info&&(i.data.data.info.duty_position_id=String(i.data.data.info.duty_position_id)),t.formData=i.data.data.info,t.formData.location_address=i.data.data.info.location):t.$message({showClose:!0,message:i.data.msg,type:"error"});case 4:case"end":return a.stop()}},a,t)}))()},getList:function(){var e=this;return o()(s.a.mark(function t(){var a,i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={page:e.page,pageSize:e.pageSize,device_type:e.search.device_id,location:e.search.address,title:e.search.name},t.next=3,e.axios.post(n._9,a);case 3:1==(i=t.sent).data.code?(i.data.data.data.forEach(function(e){1==e.disabled?e.disabled=!1:e.disabled=!0}),e.tableData=i.data.data.data,e.total=i.data.data.total):e.$message({showClose:!0,message:i.data.msg,type:"error"});case 5:case"end":return t.stop()}},t,e)}))()},typeList:function(e){var t=this;return o()(s.a.mark(function a(){var i;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.axios.post(n._17,{device_type:e});case 2:1==(i=a.sent).data.code?t.deviceList=i.data.data:t.$message({showClose:!0,message:i.data.msg,type:"error"});case 4:case"end":return a.stop()}},a,t)}))()},resView:function(){var e=this;return o()(s.a.mark(function t(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.axios.post(n._18);case 2:1==(a=t.sent).data.code?(e.deviceType=a.data.data.deviceType,e.positionData=a.data.data.positionData,e.dutyStation=a.data.data.dutyStation,e.poinType=a.data.data.pointTypes,e.warningLight=[],a.data.data.device.forEach(function(t){6==t.device_type&&e.warningLight.push(t)})):e.$message({showClose:!0,message:a.data.msg,type:"error"});case 4:case"end":return t.stop()}},t,e)}))()},getHash:function(){var e=this;return o()(s.a.mark(function t(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.axios.post(n._20,{page_hash:"equipmentManagement"});case 2:1==(a=t.sent).data.code?e.hash=a.data.data:e.$message({showClose:!0,message:a.data.msg,type:"error"});case 4:case"end":return t.stop()}},t,e)}))()},submit:function(){var e,t=this;this.$refs.formData.validate((e=o()(s.a.mark(function e(a){var i,r,o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=12;break}return e.next=3,t.getHash();case 3:return i={device_code:t.formData.device_code,device_type:t.formData.device_type,location:t.formData.location_address,device_name:t.formData.device_name,relevancy_id:t.formData.relevancy_id,lamp_device_id:t.formData.lamp_device_id,duty_position_id:t.formData.duty_position_id,ip_address:t.formData.ip_address,hash:t.hash,point_type:t.formData.point_type},r=void 0,"新增设备"==t.title?r=n._4:(r=n._7,i.id=t.formData.id),e.next=8,t.axios.post(r,i);case 8:1==(o=e.sent).data.code?(t.$message({showClose:!0,message:o.data.msg,type:"success"}),t.dialogFormVisible=!1):t.$message({showClose:!0,message:o.data.msg,type:"error"}),t.getList(),t.getHash();case 12:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},delBtn:function(e){var t=this;this.$confirm("是否确定删除该设备","删除提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a={id:e};t.axios.post(n._5,a).then(function(e){1==e.data.code?(t.$notify.success({showClose:!0,message:e.data.msg,type:"success"}),(t.total-1)%t.pageSize==0&&t.total>1&&(t.page-=1),t.getList()):t.$notify.error({title:"失败",message:e.data.msg})});t.getHash()}).catch(function(e){t.$notify.error({title:"失败",message:"取消操作"})})}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"equipmentManagement"},[a("div",{staticClass:"search"},[a("el-select",{attrs:{clearable:"",size:"small",placeholder:"请选择设备类型"},model:{value:e.search.device_id,callback:function(t){e.$set(e.search,"device_id",t)},expression:"search.device_id"}},e._l(e.deviceType,function(e){return a("el-option",{key:e.id,attrs:{label:e.value,value:e.id}})}),1),e._v(" "),a("el-input",{attrs:{placeholder:"请选择设备名称",clearable:"",size:"small"},model:{value:e.search.name,callback:function(t){e.$set(e.search,"name",t)},expression:"search.name"}}),e._v(" "),a("el-cascader",{attrs:{filterable:"",size:"small",options:e.positionData,props:{checkStrictly:!0,value:"id",label:"title",emitPath:!1},clearable:""},on:{change:e.nodeChange},model:{value:e.search.address,callback:function(t){e.$set(e.search,"address",t)},expression:"search.address"}}),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",plain:"",icon:"el-icon-search"},on:{click:function(t){return e.serchList()}}},[e._v("查询")]),e._v(" "),a("div",{staticClass:"add"},[a("el-button",{staticClass:"btn_add",attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:e.add}},[e._v("新增设备")])],1)],1),e._v(" "),a("div",{staticClass:"home_table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","element-loading-background":"rgba(0, 0, 0, 0.4)","max-height":e.tableHeight,size:"medium"}},[e._l(e.tableHead,function(t,i){return["disabled"!=t.prop?a("el-table-column",{key:i,attrs:{prop:t.prop,align:"center",label:t.title,"min-width":t.minWidth,"show-overflow-tooltip":!0}}):a("el-table-column",{key:i,attrs:{prop:t.prop,align:"center",label:t.title,"min-width":t.minWidth},scopedSlots:e._u([{key:"default",fn:function(i){return[a("el-switch",{on:{change:function(a){return e.statusChange(i.row,e.tableData[i.$index][t.prop])}},model:{value:e.tableData[i.$index][t.prop],callback:function(a){e.$set(e.tableData[i.$index],t.prop,a)},expression:"tableData[scope.$index][item.prop]"}})]}}],null,!0)})]}),e._v(" "),a("el-table-column",{attrs:{prop:"address",label:"操作",fixed:"right",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.editBtn(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.check(t.row)}}},[e._v("查看")]),e._v(" "),a("el-button",{staticStyle:{color:"#ff2b2b"},attrs:{type:"text",size:"small"},on:{click:function(a){return e.delBtn(t.row.id)}}},[e._v("删除")])]}}])})],2)],1),e._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{staticClass:"pagination",attrs:{background:"","current-page":e.page,"page-sizes":[15,30,50,100],"page-size":e.pageSize,layout:"prev, pager, next, sizes,total",total:e.total,"hide-on-single-page":e.total<15},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:e.title,visible:e.dialogFormVisible,width:"700px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.handleClose}},[a("el-form",{ref:"formData",attrs:{model:e.formData,disabled:e.checked,rules:e.rule,"label-width":"110px"}},[a("el-form-item",{attrs:{label:"设备类型",prop:"device_type"}},[a("el-select",{attrs:{placeholder:"请选择设备类型"},model:{value:e.formData.device_type,callback:function(t){e.$set(e.formData,"device_type",t)},expression:"formData.device_type"}},e._l(e.deviceType,function(e){return a("el-option",{key:e.id,attrs:{label:e.value,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"设备名称",prop:"device_name"}},[a("el-input",{attrs:{placeholder:"请输入设备名称"},model:{value:e.formData.device_name,callback:function(t){e.$set(e.formData,"device_name",t)},expression:"formData.device_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"设备码",prop:"device_code"}},[a("el-input",{attrs:{placeholder:"请输入设备码"},model:{value:e.formData.device_code,callback:function(t){e.$set(e.formData,"device_code",t)},expression:"formData.device_code"}})],1),e._v(" "),4==e.formData.device_type?a("el-form-item",{attrs:{label:"点位类型",prop:"point_type"}},[a("el-select",{attrs:{placeholder:"请选择点位类型"},model:{value:e.formData.point_type,callback:function(t){e.$set(e.formData,"point_type",t)},expression:"formData.point_type"}},e._l(e.poinType,function(e){return a("el-option",{key:e.id,attrs:{label:e.value,value:e.id}})}),1)],1):e._e(),e._v(" "),3==e.formData.device_type?a("el-form-item",{attrs:{label:"关联设备类型",prop:"relevancy_device_type"}},[a("el-select",{attrs:{placeholder:"请选择关联设备类型",clearable:""},on:{change:e.typeChange},model:{value:e.formData.relevancy_device_type,callback:function(t){e.$set(e.formData,"relevancy_device_type",t)},expression:"formData.relevancy_device_type"}},e._l(e.type,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1):e._e(),e._v(" "),3==e.formData.device_type?a("el-form-item",{attrs:{label:"关联设备",prop:"relevancy_id"}},[a("el-select",{attrs:{placeholder:"请选择关联设备",clearable:""},model:{value:e.formData.relevancy_id,callback:function(t){e.$set(e.formData,"relevancy_id",t)},expression:"formData.relevancy_id"}},e._l(e.deviceList,function(e){return a("el-option",{key:e.id,attrs:{label:e.device_name,value:e.id}})}),1)],1):e._e(),e._v(" "),3==e.formData.device_type?a("el-form-item",{attrs:{label:"关联预警灯",prop:"lamp_device_id"}},[a("el-select",{attrs:{placeholder:"请选择关联预警灯",clearable:""},model:{value:e.formData.lamp_device_id,callback:function(t){e.$set(e.formData,"lamp_device_id",t)},expression:"formData.lamp_device_id"}},e._l(e.warningLight,function(e){return a("el-option",{key:e.id,attrs:{label:e.device_name,value:e.id}})}),1)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"设备所在位置",prop:"equipment_location"}},[a("el-cascader",{attrs:{options:e.positionData,props:{checkStrictly:!0,value:"id",label:"title",emitPath:!1},clearable:""},on:{change:e.nodeChange},model:{value:e.formData.location_address,callback:function(t){e.$set(e.formData,"location_address",t)},expression:"formData.location_address"}})],1),e._v(" "),3==e.formData.device_type?a("el-form-item",{attrs:{label:"关联值班地点",prop:"duty_position_id"}},[a("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.formData.duty_position_id,callback:function(t){e.$set(e.formData,"duty_position_id",t)},expression:"formData.duty_position_id"}},e._l(e.dutyStation,function(e){return a("el-option",{key:e.dictionary_value,attrs:{label:e.dictionary_name,value:e.dictionary_value}})}),1)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"IP地址"}},[a("el-input",{attrs:{placeholder:"请输入IP..."},model:{value:e.formData.ip_address,callback:function(t){e.$set(e.formData,"ip_address",t)},expression:"formData.ip_address"}})],1)],1),e._v(" "),e.checked?e._e():a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(l,c,!1,function(e){a("2+As")},"data-v-198de12d",null);t.default=d.exports}});
//# sourceMappingURL=43.bfe1806cf3f82629e3d9.js.map